# Nacos 配置文件: documind-gateway.yaml
# Data ID: documind-gateway.yaml
# Group: DEFAULT_GROUP

server:
  port: 8080

spring:
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true # 开启从注册中心动态创建路由的功能
          lower-case-service-id: true # 使用小写服务名
      routes:
        # 认证服务路由
        - id: documind-auth
          uri: lb://documind-auth
          predicates:
            - Path=/auth/**
          filters:
            - StripPrefix=1 # 去掉前缀 /auth

        # 系统服务路由
        - id: documind-system
          uri: lb://documind-system
          predicates:
            - Path=/system/**
          filters:
            - StripPrefix=1

        # 文档服务路由
        - id: documind-document
          uri: lb://documind-document
          predicates:
            - Path=/document/**
          filters:
            - StripPrefix=1

        # AI 服务路由 (Python)
        - id: documind-ai
          uri: lb://documind-ai-python # 注意这里对应 Python 服务名
          predicates:
            - Path=/ai/**
          filters:
            - StripPrefix=1

      # 跨域配置
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins: "*"
            allowedMethods: "*"
            allowedHeaders: "*"
            allowCredentials: false # 如果 allowOrigins 为 *，必须为 false
